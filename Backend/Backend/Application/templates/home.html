<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/login.css">
    <style>
        /* Custom CSS for positioning the button */
        #goToThirdScreen {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 999; /* Ensures the button is above other elements */
        }
    </style>
</head>

<body>

    <div class='bg-rain'>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-2">
                </div>
                <div class="col-md-8" style="padding-top: 100px;">
                    <div class="card d-flex justify-content-center align-items-center"
                        style="background-color: #f1f2ed; border-radius: 1rem; padding: 45px 45px;">

                        <div id='loginInfo' class="rounded-1"
                            style="width: 95%; height: 80%; background-color: #f1f2ed; padding: 50px 50px; font-size: 40px;">
                            You have successfully logged in!
                            This page calculates the nearest sea from your GPS coordinates. 
                        </div>
                        <button id="getLocation" class="btn btn-teal mt-5">
                            Allow GPS
                        </button>
                        <div id="distanceInfo" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button id="goToThirdScreen" class="btn btn-primary" onclick="redirectToPage()">Go to the third screen</button>
    <script>
    function redirectToPage() {
        window.location.href = "/calculate";
    }
    </script>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>

    <script>
        document.getElementById('getLocation').addEventListener('click', getLocation);

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showDistance);
            } else {
                alert('Geolocation is not supported by this browser.');
            }
        }

        function showDistance(position) {
            const userLatitude = position.coords.latitude;
            const userLongitude = position.coords.longitude;

            const seaCoordinates = [
                { name: 'Black Sea', latitude: 43.28, longitude: 34.18, }, // coordinates for Black Sea
                { name: 'Mediterranean Sea', latitude: 38.02, longitude: 15.09, }, // coordinates for Black Sea
                { name: 'Marmara Sea', latitude: 40.67, longitude: 28.15, },
                { name: 'Adriatic Sea', latitude: 42.73, longitude: 16.04, },
                { name: 'Aegean Sea', latitude: 37.85, longitude: 25.17, },
                { name: 'Alboran Sea', latitude: 35.91, longitude: -3.32, },
                { name: 'Andaman Sea', latitude: 11.20, longitude: 95.66, },
                { name: 'Arabian Sea ', latitude: 13.34, longitude: 64.00, },
                { name: 'Arafura Sea', latitude: -10.52, longitude: 136.96, },
            ];

            let nearestSea = '';
            let minDistance = Number.MAX_VALUE;

            for (const sea of seaCoordinates) {
                const distance = calculateDistance(userLatitude, userLongitude, sea.latitude, sea.longitude);
                if (distance < minDistance) {
                    minDistance = distance;
                    nearestSea = sea.name;
                }
            }

            document.getElementById('distanceInfo').innerText = `Distance to the nearest sea (${nearestSea}): ${minDistance.toFixed(2)} km`;
        }

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Radius of the Earth in km
            const dLat = deg2rad(lat2 - lat1);
            const dLon = deg2rad(lon2 - lon1);
            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            const distance = R * c;
            return distance;
        }

        function deg2rad(deg) {
            return deg * (Math.PI / 180);
        }

    </script>
</body>

</html>
